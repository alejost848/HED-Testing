<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../paper-behaviors/paper-button-behavior.html">
<link rel="import" href="../paper-ripple/paper-ripple.html">

<script src="howler.min.js"></script>

<dom-module id="the-icon">

  <style>
   :host {
      display: inline-block;
      position: relative;
      color: #ffffff;
      margin: 0px -15px;
      width: 130px;
      height: 130px;
      cursor: pointer;
      padding: 8px;
      stroke: white;
      -webkit-transform: rotate(-45deg) scale(0.85);
      transform: rotate(-45deg) scale(0.85);

      -webkit-transition: transform 0.5s;
      transition: transform 0.5s;

      -webkit-transition-timing-function: ease;
      transition-timing-function: ease;
    }
    
    :host #ink {
      -webkit-transform: rotate(0deg);
      transform: rotate(0deg);
    }

    #icon {
      width: 100%;
      height: 100%;
    }

    @media (max-width: 1500px) {  
      :host {
        width: 100px;
        height: 100px;
      }
    }
    @media (max-width: 1200px) {
      :host {
        width: 90px;
        height: 90px;
      }
    }
    @media (max-width: 850px) {
      :host {
        width: 90px;
        height: 90px;
        margin: 0px -12px;
      }
    }
    @media (max-width: 370px) {
      :host {
        width: 75px;
        height: 75px;
      }
    }
  </style>

  <template>
    <paper-ripple id="ink" recenters></paper-ripple>
    <iron-icon id="icon" icon="[[icon]]"></iron-icon>
  </template>

  <script>

    var sound = new Howl({
      src: ['zawette_samples/lead.mp3'],
      autoplay: false,
    });
    var sound2 = new Howl({
      src: ['zawette_samples/hihats.mp3'],
      autoplay: false,
    });
    var sound3 = new Howl({
      src: ['zawette_samples/kick.mp3'],
      autoplay: false,
    });
    var sound4 = new Howl({
      src: ['zawette_samples/bass.mp3'],
      autoplay: false,
    });
    var sound5 = new Howl({
      src: ['zawette_samples/rhodes.mp3'],
      autoplay: false,
    });
    var sound6 = new Howl({
      src: ['zawette_samples/st1.mp3'],
      autoplay: false,
    });
    var sound7 = new Howl({
      src: ['zawette_samples/saxo.mp3'],
      autoplay: false,
    });
    var sound8 = new Howl({
      src: ['zawette_samples/st2.mp3'],
      autoplay: false,
    });
    var sound9 = new Howl({
      src: ['zawette_samples/sthit.mp3'],
      autoplay: false,
    });

    var songList = [];
    songList.push(sound,sound2,sound3,sound4,sound5,sound6,sound7,sound8,sound9);
  
    Polymer({

      is: 'the-icon',

      listeners: {
        'tap': 'regularTap'
      },

      properties: {
        icon: {
          type: String
        },
        identifier: {
          type: String
        },
        active: {
          type: Boolean,
          value: false
        },
        unlocked: {
          type: Boolean,
          value: false
        }
      },

      attached:function() {
        this.$.ink.initialOpacity = 1;
        this.$.ink.opacityDecayVelocity = 2;
        this._updateColors();

        if(!this.unlocked){
          this.$.ink.style.color = '#242424';
        }
      },

      regularTap: function() {
        if(this.unlocked){
          this.$.ink.downAction();
          this.$.ink.holdDown=!this.$.ink.holdDown;
          this.active=this.$.ink.holdDown;
        }
      },

      stopSound: function() {
        if(this.unlocked){
          songList[this.identifier].stop();
          this.$.ink.holdDown=false;
        }
      },

      playSample: function() {
        if(this.unlocked){
          songList[this.identifier].stop();
          songList[this.identifier].play(); 
        }     
      },

      _updateColors: function() {
        switch(this.identifier){
          case "0":
            this.$.ink.style.color = '#b10022';
          break;
          case "1":
            this.$.ink.style.color = '#ca0027';
          break;
          case "2":
            this.$.ink.style.color = '#e3002c';
          break;
          case "3":
            this.$.ink.style.color = '#fd0031';
          break;
          case "4":
            this.$.ink.style.color = '#ff1744';
          break;
          case "5":
            this.$.ink.style.color = '#fd0031';
          break;
          case "6":
            this.$.ink.style.color = '#e3002c';
          break;
          case "7":
            this.$.ink.style.color = '#ca0027';
          break;
          case "8":
            this.$.ink.style.color = '#b10022';
          break;
        }
        if(!this.unlocked){
          this.$.icon.style.stroke = "rgba(0,0,0,1)";
        }else{
          this.$.icon.style.stroke = "#ffffff";
        }
      }

    });

  </script>

</dom-module>